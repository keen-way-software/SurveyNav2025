graph:
  startId: Start
  nodes:
    - id: Start
      type: START
      title: Anza
      question: Anza
      nextId: Q1

    - id: Q1
      type: AI
      title: Hasara ya Mavuno kutokana na Funza wa Jeshi Vamizi (Misimu 3)
      question: >-
        Unapoteza mavuno kiasi gani kutokana na funza wa jeshi vamizi (FAW)? Tafadhali fikiria misimu mitatu iliyopita. (Asilimia au magunia kwa ekari ni sawa.)
      nextId: Q2

    - id: Q2
      type: AI
      title: Ubadilishanaji kwa Kuvuna Mapema kwa Siku 10
      question: >-
        Ikiwa ungeweza kuvuna siku 10 mapema, ungekuwa tayari kupunguza mavuno kiasi gani? (Asilimia au magunia kwa ekari.)
      nextId: Q3

    - id: Q3
      type: AI
      title: Kizingiti cha Uharibifu cha Kubadili Aina ya Mahindi
      question: >-
        Ni kiwango gani cha uharibifu wa wadudu au magonjwa kingekufanya uache kutumia aina yako ya sasa ya mahindi na ubadilishe kwenda aina mpya? (Toa kigezo wazi, kwa mfano: asilimia ya mimea au masikio yaliyoharibika, au kiwango cha ukali.)
      nextId: Q4

    - id: Q4
      type: AI
      title: Matarajio ya Aina Mpya ya Kuchukua Nafasi
      question: >-
        Ungetarajia nini kutoka kwa aina mpya ya mahindi ili kuchukua nafasi ya ile unayolima sasa? Tafadhali toa maelezo kwa undani kadiri inavyowezekana (kwa mfano, muda wa kukomaa (DTM), uvumilivu wa FAW, uvumilivu wa ukame katika hatua fulani, mavuno ya kawaida).
      nextId: Q5

    - id: Q5
      type: AI
      title: Mavuno ya Chini Yanayokubalika Katika Mwaka Mbaya
      question: >-
        Katika mwaka mbaya, ni mavuno madogo kiasi gani ambayo ungeyakubali na bado ukapande mahindi haya tena msimu unaofuata? (Asilimia ya mavuno ya kawaida au magunia kwa ekari.)
      nextId: Q6

    - id: Q6
      type: AI
      title: Wakati wa Ukame Unaoharibu Zaidi
      question: >-
        Ni kipindi gani katika msimu ambapo ukame unaathiri mazao yako kwa kiwango kikubwa zaidi? Ni wakati gani wa ukame ambao ni mgumu zaidi kwako? (Kwa mfano, kabla ya kutoa maua, wakati wa kutoa maua/kuchanua, kujaza punje, kabla ya kuvuna.)
      nextId: Review

    - id: Review
      type: REVIEW
      title: Kagua
      question: ''
      nextId: Done

    - id: Done
      type: DONE
      title: Imekamilika
      question: ''

slm:
  accelerator: "GPU"
  max_tokens: 4096
  top_k: 10
  top_p: 0.2
  temperature: 0.3
  user_turn_prefix: "<start_of_turn>user"
  model_turn_prefix: "<start_of_turn>model"
  turn_end: "<end_of_turn>"
  empty_json_instruction: "Respond with an empty JSON object: {}"
  preamble: "You are a well-known farmer survey expert. Read the Question and the Answer."
  key_contract: |
    OUTPUT FORMAT:
    - All Values in Swahili.
    - Keys:
      • "analysis": short string
      • "expected answer": short string
      • "follow-up question": a single short confirm/validate question (NOT an array)
      • "score": integer 1–100
    FOLLOW-UP INTENT:
    - The follow-up must confirm or clarify the respondent's original answer to the SAME question.
    - It must target the biggest uncertainty: missing unit/scale, missing number, time window, baseline, or method used.
    - Keep it single-scope (no multi-part), concrete, and answerable immediately.
    - Do not introduce new topics or additional objectives.
  length_budget: |
    LENGTH LIMITS:
    - analysis<=60 chars; follow-up<=120; expected answer<=120.
  scoring_rule: "Scoring rule: Judge ONLY content relevance/completeness/accuracy. Do NOT penalize style or formatting."
  strict_output: |-
    STRICT OUTPUT (NO MARKDOWN):
    - RAW JSON only, ONE LINE.
    - Use COMPACT JSON (no spaces around ':' and ',').
    - No extra text.

whisper:
  enabled: true
  asset_model_path: "models/ggml-model-q4_0.bin"
  language: "sw" # "auto", "en", "ja", "sw"
  translate: false
  print_timestamp: false
  target_sample_rate: 16000
  record_sample_rates: [16000, 48000, 44100]
  compute_checksum: true

prompts:
  - nodeId: Q1
    prompt: |-
      Task:
      - Note weaknesses (e.g., unclear units, missing seasons, outliers).
      - Provide ONE strong expected answer: avg FAW yield loss over last 3 seasons (% or bags/acre); note high variability if present.
      - Ask exactly 1 follow-up question to CONFIRM/VALIDATE the same answer (single short sentence). Prefer confirming unit + baseline or per-season values if missing.
      - Score 1–100.
      
      Question: {{QUESTION}}
      Answer: {{ANSWER}}

  - nodeId: Q2
    prompt: |-
      Task:
      - Note weaknesses (e.g., vague trade-off, no units, no rationale).
      - Provide a strong expected answer: willingness-to-accept yield loss to harvest 10 days earlier (% or bags/acre) with a one-clause reason (rain risk/price).
      - Ask exactly 1 follow-up question to CONFIRM/VALIDATE the same answer (single short sentence). Prefer clarifying the unit/amount or rationale boundary (max acceptable loss).
      - Score 1–100 (integer).
      
      Question: {{QUESTION}}
      Answer: {{ANSWER}}

  - nodeId: Q3
    prompt: |-
      Task:
      - Note weaknesses (e.g., no threshold, unclear measure, pest vs disease mixed).
      - Provide a strong expected answer: a clear switching threshold (e.g., ≥X% plants/ears with moderate+ damage, or a severity level at tasseling).
      - Ask exactly 1 follow-up question to CONFIRM/VALIDATE the same answer (single short sentence). Prefer confirming the metric/scale or growth stage window.
      - Score 1–100 (integer).
      
      Question: {{QUESTION}}
      Answer: {{ANSWER}}

  - nodeId: Q4
    prompt: |-
      Task:
      - Note weaknesses (e.g., generic traits, missing numbers).
      - Provide a strong expected answer listing 2 compact replacement targets with numeric/categorical thresholds.
      - Ask exactly 1 follow-up question to CONFIRM/VALIDATE the same answer (single short sentence). Prefer confirming the top-priority trait or a numeric target.
      - Score 1–100 (integer).
      
      Question: {{QUESTION}}
      Answer: {{ANSWER}}

  - nodeId: Q5
    prompt: |-
      Task:
      - Note weaknesses (e.g., no baseline, no unit, no decision rule).
      - Provide a strong expected answer: minimum acceptable harvest in a bad year (% or bags/acre) plus a terse rule.
      - Ask exactly 1 follow-up question to CONFIRM/VALIDATE the same answer (single short sentence). Prefer confirming baseline average or a concrete bad-year example.
      - Score 1–100 (integer).
      
      Question: {{QUESTION}}
      Answer: {{ANSWER}}

  - nodeId: Q6
    prompt: |-
      Task:
      - Note weaknesses (e.g., vague timing, no stage, no symptoms).
      - Provide a strong expected answer: most damaging drought moment as a crop stage with a one-clause reason.
      - Ask exactly 1 follow-up question to CONFIRM/VALIDATE the same answer (single short sentence). Prefer confirming the stage definition or a concrete season example.
      - Score 1–100 (integer).
      
      Question: {{QUESTION}}
      Answer: {{ANSWER}}

model_defaults:
  # Model download UI defaults

  default_model_url: "https://huggingface.co/google/gemma-3n-E4B-it-litert-lm/resolve/main/gemma-3n-E4B-it-int4.litertlm"
  default_file_name: "Gemma3n4B.litertlm"

  # default_model_url: "https://huggingface.co/CraneAILabs/swahili-gemma-1b-litert/resolve/main/swahili-gemma-1b-fp16-instruct.task"
  # default_file_name: "swahili-gemma-1b-fp16.task"

  # default_model_url: "https://huggingface.co/google/gemma-3n-E2B-it-litert-lm/resolve/main/gemma-3n-E2B-it-int4.litertlm"
  # default_file_name: "Gemma3n2B.litertlm"
  # default_model_url: "https://huggingface.co/litert-community/Gemma3-1B-IT/resolve/main/gemma3-1b-it-int4.litertlm"
  # default_file_name: "Gemma31B.litertlm"
  # default_model_url: "https://huggingface.co/litert-community/Gemma2-2B-IT/resolve/main/Gemma2-2B-IT_multi-prefill-seq_q8_ekv1280.task"
  # default_file_name: "Gemma2-2B.task"
  # default_model_url: "https://huggingface.co/litert-community/Qwen2.5-0.5B-Instruct/resolve/main/Qwen2.5-0.5B-Instruct_multi-prefill-seq_q8_ekv1280.task"
  # default_file_name: "Qwen2-5-0-5B.task"
  # default_model_url: "https://huggingface.co/litert-community/Phi-4-mini-instruct/resolve/main/phi4_q8_ekv1280.task"
  # default_file_name: "phi4_q8_ekv1280.task"

  # Optional tuning knobs (keep same defaults as code)
  timeout_ms: 1800000          # 30 minutes
  ui_throttle_ms: 250
  ui_min_delta_bytes: 1048576  # 1 MiB
